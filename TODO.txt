========================
TODOs für die uap v0.0.2
========================

Zombie-Prozesse? (Don't do)
---------------------------

* uap scheint Prozesse zu erzeugen die weiterlaufen nachdem der Hauptprozesse
  getötet wurde. Warum werden die Kinderprozesse nicht gestoppt wenn der Eltern
  Prozess gestoppt wird?
* qdel von Jobs hinterlässt noch laufende Prozesse (produzierbar auch mit normalen Pipes)


Zusammenspiel von <project>.yaml und Submit Script Template (Christoph)
-----------------------------------------------------------------------

* in der Project Config kann man folgendes angeben:

cluster:
    default_submit_options: "-pe smp #{CORES} -cwd -S /bin/bash -m as -l h_rt=48:00:00 -l h_vmem=4G"
    default_pre_job_command: "module ..."
    default_post_job_command: "module ..."
    default_job_quota: <int>

** Pro Step kann man die default Werte überschreiben:

steps:
    step_a:
        _cluster_submit_options: "..."
        _cluster_pre_job_command: "..."
        _cluster_post_job_command: "..."

*** die default Werte zu überschreiben


!!!
    Die folgende Idee ist schwer umsetzbar. Einzige Möglichkeit wäre das
    Tool checking auf den Cluster Nodes abzustellen. Außerdem benötigt man
    dann zwei module load/unload Kommandos:
    1. eine Version für das Laden von Modulen in Python
    2. eine Version für die BASH
    das bläht die Config auf für wenig bis keinen Mehrwert.
!!!
** Pro Tool sollte es die Möglichkeit geben:
*** ein module load/unload Kommando anzugeben das dann einfach in das
    Submit Skript Template geschrieben wird

Dokumentation (Alexander + Christoph + Sven)
--------------------------------------------

Es wäre super wenn wir eine FAQ Seite für die häufigsten
Fehlermeldungen haben würden (für Alexander aber auch alle anderen).
Die Doku des fastq_source Steps sollte ein Beispiel für ein YAML
dictionary enthalten.
Generell muss die Doku auf fehlenden Inhalt Kontroll gelesen werden.
--even-if-dirty Zweck beschreiben 

Docker (Alexander/Christoph) (Geringste Prio)
---------------------------------------------

Docker Support einbauen mittels Dockerfiles. Sitze ich gerade dran (Christoph).

Pfadangaben für Dateien die aus uap geladen werden (Sven)
---------------------------------------------------------

absolute Pfadangaben für alle open() calls.
Dateien und Verzeichnisse werden in Abhängigkeit vom Ort, von dem die uap ausgeführt wird, geschrieben... absoluten Dateipfad erzeugen und benutzen?

Debugging (???)
---------------

Submit Script in Annotation Datei speichern. (Done)
Prosa Log nach STDERR mittels logger 
Evtl. Subcommand fürs zusammensuchen von Ausgabedaten des Runs.

* Invaild state: WAITING -> besser siehe Notizen

Weitere Ideen
-------------

* Verteilen von uap über PyPI (Python Package Repos)


Mailinglist/GitHub Issue Tracker
--------------------------------

* Vorbereiten das wir für Fehlermeldungen erreichbar sind

Documentation
=============

* FAQ für häufig Fehler
* Problem: steps.rst wird dynamisch durch stepdoc.py erzeugt
* Lösung: conf.py erweitern mit stepdoc.py damit die Doku automatisch aktualisiert wird?
** funktioniert nicht. immer manuell ausführen?
** nicht alle Inhalte sind dann perfekt formatiert, manuelle Bearbeitungen gehen nach dem neu erzeugen verloren
* Verwendung von AbstractStep::runs() beschreiben in Doku anstatt von self.declare_run() und execute()
** http://uap.readthedocs.io/en/latest/extension.html
* Bemerkung zur scheinbar sporadischen Verwendung von fifos, dd usw? Tool abhängige Nutzung von FIFOs
* narrowpeak_to_bed fehlt als Datei in Repository (ist noch bei mit lokal)

Examples
--------

* abändern der Beispiele für neue Version
* zwei Klassen von Beispielen (mit ungefährer CPU-/Speicher-/Dauer-Abschätzung)
** kleine (weniger rechenintensive) Beispiele
** richtige (rechenintensive/speicherhungrige) Beispiele 

Logging
=======

* Fehlermeldungen kürzen
** "Pipeline crashed"
* Stacktrace nur anzeigen wenn log-level auf z.B. debug

Fehler
======

Fehler mit .yaml-out dokumentieren

Steps
=====

* hg19 download reparieren (index_homo_sapiens) einen Download Step erstellen
  für mehrere Dateien/Runs
* add_option(dd-blocksize) wo nötig
** dd blocksize default-mäßig auf Linux default 256k -> als add_option in jeden Schritt der dd nutzt

Umbenennungen/Aufräumen
-----------------------

* tools/ Verzeichnis aufräumen. Welche Dateien von dort werden noch benötigt?
* Verzeichnis "old_steps" unter include/steps: Löschen? Merken des commits im Wiki und dann löschen

Git Repository
==============

Organisieren eines git Repositories für uap (Jörg/Jana)


RNASeq Pipeline Meeting 2014/04/29
----------------------------------

Sven, Jörg, Kristin, Christoph, Micha

Tasks:

- is it possible to watch a processes' stderr while a step is running?
  - preferably not only if you launched in debug mode, but always, like inter-
  cepting write calls to the respective file descriptor
  - or maybe dump each monitored file's 1024 byte tail every once in a while 
  (this would be easiest and includes stdout and stderr)
- clean up in/ and out/ names - 'error', 'log', 'stderr' should in some cases
  become the same thing
  - we need a well-defined ontology of file types regardless of actual file
  type, more from the semantic perspective

Problems:
- if different sources contain identically named samples they are probably gone
  overwrite there output files handled wrong
