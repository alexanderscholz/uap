# This is the uap configuration file.
 
destination_path: genomes/bacteria/Mycoplasma_genitalium/

constants:
    - &some_constant some_value


steps:
    M_genitalium_genome_url (raw_url_source):
        hashing-algorithm: md5
        filename: 'Mycoplasma_genitalium.ASM2732v1.fna.gz'
        path: genomes/bacteria/Mycoplasma_genitalium/
        secure-hash: a3e6e5655e4996dc2d49f876be9d1c27
        url: ftp://ftp.ncbi.nih.gov/genomes/genbank/bacteria/Mycoplasma_genitalium/latest_assembly_versions/GCA_000027325.1_ASM2732v1/GCA_000027325.1_ASM2732v1_genomic.fna.gz

    bowtie2_index (bowtie2_generate_index):
        _depends: M_genitalium_genome_url
        _connect: 
            in/reference_sequence: M_genitalium_genome_url/raw
        index-basename: Mycoplasma_genitalium_index

    M_genitalium_uncompress (merge_fasta_files):
        _depends: M_genitalium_genome_url
        _connect:
            in/sequence: M_genitalium_genome_url/raw
        compress-output: no
        output-fasta-basename: M_genitalium_genome

    segemehl_index (segemehl_generate_index):
        _depends: M_genitalium_uncompress
        _connect: 
            in/reference_sequence: M_genitalium_uncompress/sequence
#        index-basename: Mycoplasma_genitalium_index

    bwa_index (bwa_generate_index):
        _depends: M_genitalium_uncompress
        _connect: 
            in/reference_sequence: M_genitalium_uncompress/sequence
#        index-basename: Mycoplasma_genitalium_index

    samtools_faidx:
        _depends: M_genitalium_uncompress


tools:
    ##################
    # External Tools #
    ##################

    # URL: https://github.com/arq5x/bedtools2
    bedtools:
        path: 'bedtools'
        get_version: '--version'
        exit_code: 0

    # URL: http://bowtie-bio.sourceforge.net/bowtie2/index.shtml
    bowtie2:
        path: 'bowtie2'
        get_version: '--version'
        exit_code: 0

    # URL: http://bowtie-bio.sourceforge.net/bowtie2/index.shtml
    bowtie2-build:
        path: 'bowtie2-build'
        get_version: '--version'
        exit_code: 0

    # URL: https://github.com/lh3/bwa
    bwa:
        path: bwa
        get_version: ''
        exit_code: 1

    # URL: http://cufflinks.cbcb.umd.edu/
#    cufflinks:
#        path: 'cufflinks'
#        get_version: '--version'
#        exit_code: 1

    # URL: https://github.com/marcelm/cutadapt
    cutadapt:
        path: 'cutadapt'
        get_version: '--version'
        exit_code: 0

    # URL: http://www.bioinformatics.babraham.ac.uk/projects/fastqc/
    fastqc:
        path: 'fastqc'
        get_version: '--version'
        exit_code: 0

    # URL: https://github.com/taoliu/MACS/
    # Installation via 'pip install MACS2'
    macs2:
        path: 'macs2'
        get_version: '--version'
        exit_code: 0

    # URL: http://broadinstitute.github.io/picard/
#    MarkDuplicates:
#        path: 'MarkDuplicates'
#        get_version: '--version'
#        exit_code: 1

    # URL: http://zlib.net/pigz/
    pigz: 
        path: 'pigz'
        get_version: '--version'
        exit_code: 0

    # URL: http://smithlabresearch.org/software/preseq/
    preseq:
        path: 'preseq'
        get_version: ''
        exit_code: 0
    
    # URL: http://www.htslib.org/
    samtools:
        path: 'samtools'
        get_version: ''
        exit_code: 1

    # URL: http://www.bioinf.uni-leipzig.de/Software/segemehl/
    segemehl:
        path: 'segemehl.x'
        get_version: ''
        exit_code: 255

    # URL: http://ccb.jhu.edu/software/tophat/index.shtml
    tophat2:
        path: 'tophat2'
        get_version: '--version'
        exit_code: 0

    bedGraphToBigWig:
        path: 'bedGraphToBigWig'
        get_version: ''
        exit_code: 255

    ##################
    # Internal Tools #
    ##################

    compare_secure_hashes:
        path: '../tools/compare_secure_hashes.py'
        get_version: '--version'
        exit_code: 0

#    fix_cutadapt:
#        path: '../tools/fix_cutadapt.py'
#        get_version: '--version'
#        exit_code: 0
#
#    fix_s2c:
#        path: ['./python_env/bin/python', './tools/fix_s2c.py']
#        exit_code: 1
#
#    fix_qnames:
#        path: ['./python_env/bin/python', './tools/fix_qnames.py']
#        exit_code: 0
#
#    mate_pair_strand_switch:
#        path: ['./python_env/bin/python', './tools/mate_pair_strand_switch.py']
#        get_version: '--version' 
#        exit_code: 0
#
#    remove_reads_segemehl:
#        path: ['./python_env/bin/python', './tools/remove_reads_segemehl.py']
#        exit_code: 1
#
#    s2c:
#        path: ['./python_env/bin/python', './tools/s2c.py']
#        get_version: ''
#        exit_code: 2

    ##############
    # Unix Tools #
    ##############

    cat:
        path: cat
        get_version: '--version'
        exit_code: 0

    cp:
        path: cp
        get_version: '--version'
        exit_code: 0

    curl:
        path: curl
        get_version: '--version'
        exit_code: 0

    dd:
        path: dd
        get_version: '--version'
        exit_code: 0

    head:
        path: head
        get_version: '--version'
        exit_code: 0

    grep:
        path: grep
        get_version: '--version'

    md5sum:
        path: 'md5sum'
        get_version: '--version'
        exit_code: 0

    mkdir:
        path: mkdir
        get_version: '--version'
        exit_code: 0

    mkfifo:
        path: mkfifo
        get_version: '--version'
        exit_code: 0

    mv:
        path: mv
        get_version: '--version'
        exit_code: 0

    sort:
        path: 'sort'
        get_version: '--version'
        exit_code: 0

    sha1sum:
        path: sha1sum
        get_version: '--version'
        exit_code: 0

    wc:
        path: 'wc'
        get_version: '--version'

